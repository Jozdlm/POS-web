"use strict";(self.webpackChunkpos_web_client=self.webpackChunkpos_web_client||[]).push([[296],{7845:(T,h,e)=>{e.d(h,{S:()=>t});var t=function(n){return n.QUOTATIONS="quotation_header",n.QUOTATION_ITEMS="quotation_items",n.PRODUCTS="products",n.CATEGORIES="categories",n.SCHOOL_GRADES="school_grades",n.SCHOOLS="schools",n.PROMOTION_TYPE="promotion_type",n}(t||{})},1296:(T,h,e)=>{e.r(h),e.d(h,{default:()=>A});var t=e(6242),n=e(6814),m=e(9308),l=e(9310),p=e(3947);const f=(i,O)=>O.id,y=i=>["edit",i];function d(i,O){if(1&i&&(t.TgZ(0,"div",5)(1,"div")(2,"p",6),t._uU(3),t.qZA(),t._UZ(4,"span",7),t.qZA(),t.TgZ(5,"div")(6,"a",8),t._uU(7,"Editar"),t.qZA()()()),2&i){const r=O.$implicit;t.xp6(3),t.hij(" ",r.name," "),t.xp6(1),t.Q6J("recordStatus",r.isActive),t.xp6(2),t.Q6J("routerLink",t.VKq(3,y,r.id))}}let u=(()=>{class i{constructor(){this.schools$=(0,t.f3M)(m.E).getSchools()}static#t=this.\u0275fac=function(s){return new(s||i)};static#o=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-schools"]],standalone:!0,features:[t.jDz],decls:10,vars:2,consts:[[1,"wrapper"],[1,"d-flex","justify-content-between","align-items-center","mb-3"],[1,"fs-3"],["routerLink","add",1,"btn","btn-primary"],[1,"list-group"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"fw-medium","fs-5","mb-0"],[1,"badge","rounded-pill",3,"recordStatus"],[1,"btn",3,"routerLink"],["class","list-group-item d-flex justify-content-between align-items-center"]],template:function(s,v){1&s&&(t.TgZ(0,"div",0)(1,"div",1)(2,"h1",2),t._uU(3,"Centros Educativos"),t.qZA(),t.TgZ(4,"a",3),t._uU(5,"Crear colegio"),t.qZA()(),t.TgZ(6,"div",4),t.SjG(7,d,8,5,"div",9,f),t.ALo(9,"async"),t.qZA()()),2&s&&t.wJu(7,t.lcZ(9,0,v.schools$))},dependencies:[n.ez,n.Ov,l.Bz,l.rH,p.Y],styles:[".wrapper[_ngcontent-%COMP%]{max-width:800px;margin:0 auto;width:100%}"]})}return i})();var o=e(95),c=e(7394),a=e(4664),g=e(2096);let S=(()=>{class i{constructor(){this._activatedRoute=(0,t.f3M)(l.gz),this._router=(0,t.f3M)(l.F0),this._schoolService=(0,t.f3M)(m.E),this._subscriptions=new c.w0,this.pageTitle="Crear colegio",this.categoryId=null,this.schoolForm=(0,t.f3M)(o.qu).nonNullable.group({name:["",[o.kI.required,o.kI.minLength(3)]],isActive:[!0,[o.kI.required]]}),this._subscriptions.add(this.setInitialValues()),(0,t.f3M)(t.ktI).onDestroy(()=>this._subscriptions.unsubscribe())}setInitialValues(){return this._activatedRoute.paramMap.pipe((0,a.w)(r=>{const s=r.get("id");return s?(this.pageTitle="Editar colegio",this.categoryId=parseInt(s),this._schoolService.getSchoolById(this.categoryId)):(0,g.of)(null)})).subscribe(r=>{r&&this.schoolForm.setValue({name:r.name,isActive:r.isActive})})}resetAndReturn(){this.schoolForm.reset(),this._router.navigateByUrl("schools")}onSubmitForm(){if(this.categoryId){const r=this.schoolForm.getRawValue();this._schoolService.updateSchool({...r},this.categoryId).subscribe({next:s=>this.resetAndReturn(),error:s=>console.error(s)})}else{const r=this.schoolForm.getRawValue();this._schoolService.createSchool({...r}).subscribe({next:s=>this.resetAndReturn(),error:s=>console.error(s)})}}static#t=this.\u0275fac=function(s){return new(s||i)};static#o=this.\u0275cmp=t.Xpm({type:i,selectors:[["app-school-form"]],standalone:!0,features:[t.jDz],decls:21,vars:2,consts:[[1,"wrapper"],[1,"fs-3","mb-4"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"form-floating","mb-3"],["type","text","id","schoolName","placeholder","School Name","formControlName","name",1,"form-control"],["for","schoolName"],["id","schoolState","formControlName","isActive",1,"form-select"],["value","true"],["value","false"],["for","schoolState"],[1,"d-flex","justify-content-end","column-gap-2"],["type","button",1,"btn",3,"click"],["type","submit",1,"btn","btn-primary"]],template:function(s,v){1&s&&(t.TgZ(0,"div",0)(1,"h1",1),t._uU(2),t.qZA(),t.TgZ(3,"form",2),t.NdJ("ngSubmit",function(){return v.onSubmitForm()}),t.TgZ(4,"div",3),t._UZ(5,"input",4),t.TgZ(6,"label",5),t._uU(7,"Centro educativo"),t.qZA()(),t.TgZ(8,"div",3)(9,"select",6)(10,"option",7),t._uU(11,"Activo"),t.qZA(),t.TgZ(12,"option",8),t._uU(13,"Inactivo"),t.qZA()(),t.TgZ(14,"label",9),t._uU(15,"Estado"),t.qZA()(),t.TgZ(16,"div",10)(17,"button",11),t.NdJ("click",function(){return v.resetAndReturn()}),t._uU(18,"Cancelar"),t.qZA(),t.TgZ(19,"button",12),t._uU(20,"Guardar"),t.qZA()()()()),2&s&&(t.xp6(2),t.Oqu(v.pageTitle),t.xp6(1),t.Q6J("formGroup",v.schoolForm))},dependencies:[n.ez,o.UX,o._Y,o.YN,o.Kr,o.Fj,o.EJ,o.JJ,o.JL,o.sg,o.u],styles:[".wrapper[_ngcontent-%COMP%]{max-width:480px;margin:0 auto}"]})}return i})();const A=[{path:"",pathMatch:"full",component:u},{path:"add",component:S},{path:"edit/:id",component:S},{path:"**",redirectTo:""}]},9308:(T,h,e)=>{e.d(h,{E:()=>y});var t=e(6242),n=e(5868),m=e(7715),l=e(7398),p=e(7845);class f{static toDto(u){return{name:u.name,is_active:u.isActive}}static toEntity(u){if(!u.id)throw new Error("The Id should be provided to map from Dto to Entity");return{id:u.id,name:u.name,isActive:u.is_active}}}let y=(()=>{class d{constructor(){this._db=(0,t.f3M)(n.T).supabase}getSchools(){return(0,m.D)(this._db.from(p.S.SCHOOLS).select("*").order("id",{ascending:!0})).pipe((0,l.U)(({data:o,error:c})=>{if(c)throw new Error(c.message);return o.map(a=>f.toEntity(a))}))}getSchoolById(o){return(0,m.D)(this._db.from(p.S.SCHOOLS).select("*").eq("id",o)).pipe((0,l.U)(({data:c,error:a})=>{if(a)throw new Error(a.message);return f.toEntity(c[0])}))}createSchool(o){const c=f.toDto(o);return(0,m.D)(this._db.from(p.S.SCHOOLS).insert(c)).pipe((0,l.U)(({status:a,error:g})=>{if(g)throw new Error(g.message);return 201===a}))}updateSchool(o,c){const a=f.toDto(o);return(0,m.D)(this._db.from(p.S.SCHOOLS).update(a).eq("id",c)).pipe((0,l.U)(({status:g,error:S})=>{if(S)throw new Error(S.message);return 204===g}))}static#t=this.\u0275fac=function(c){return new(c||d)};static#o=this.\u0275prov=t.Yz7({token:d,factory:d.\u0275fac,providedIn:"root"})}return d})()}}]);