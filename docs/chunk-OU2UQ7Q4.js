import{a as V}from"./chunk-KVTM3677.js";import{a as R}from"./chunk-TSU7TQCJ.js";import"./chunk-BJOKIBL3.js";import{a as I,b as u,c as N,d as w,e as ie,f as T,g as oe,h as re,i as ne,j as ae,k as le,l as D,m as M,n as se,o as ce,p as A}from"./chunk-EEKLCBUA.js";import{e as Y,g as Z,h as ee,l as te}from"./chunk-FXASF4B2.js";import{B as q,Ga as p,I as C,Jb as F,Ka as U,La as Q,Na as g,Oa as h,Ob as X,Pa as t,Pb as k,Qa as e,Ra as f,U as m,Ua as S,Va as z,W as y,Wa as i,Xa as d,Ya as H,Za as J,a as _,bb as P,db as K,eb as v,fb as x,gb as W,j as B,n as O,u as G,va as l,x as j,za as E}from"./chunk-FFFHX7KO.js";import"./chunk-JENGY3ED.js";import{a as L}from"./chunk-5FZOKLP6.js";var me=(n,r)=>r.id;function ge(n,r){if(n&1&&(t(0,"div",22),f(1,"input",23),t(2,"label",24),i(3),e()()),n&2){let s=r.$implicit;l(1),p("id",s.name),l(1),p("for",s.name),l(1),H(" ",s.name," ")}}function he(n,r){if(n&1&&(t(0,"div",12)(1,"div",13)(2,"p",14),i(3,"Categor\xEDas"),e(),t(4,"form"),g(5,ge,4,3,"div",25,me),v(7,"async"),e()(),t(8,"div",13)(9,"label",15),i(10,"Existencias"),e(),t(11,"select",16)(12,"option",17),i(13,"Todos los registros"),e(),t(14,"option",18),i(15,"En existencia"),e(),t(16,"option",19),i(17,"Sin existencias"),e()()(),t(18,"div")(19,"label",20),i(20,"Estado"),e(),t(21,"select",21)(22,"option",17),i(23,"Todos los registros"),e(),t(24,"option",18),i(25,"Activo"),e(),t(26,"option",19),i(27,"Inactivo"),e()()()()),n&2){let s=z();h(5,x(7,0,s.categories$))}}var xe=n=>["edit",n];function _e(n,r){if(n&1&&(t(0,"div",26)(1,"div",27)(2,"div",28),i(3),e(),t(4,"div",6),i(5),e()(),t(6,"div",29)(7,"p",30),i(8),v(9,"currency"),e(),t(10,"div")(11,"span",31),i(12),e()(),t(13,"div")(14,"span",31),i(15),e()(),t(16,"button",32),i(17,"Editar"),e()()()),n&2){let s=r.$implicit;l(3),d(s.name),l(2),d(s.barcode),l(3),d(W(9,6,s.sellingPrice,"GTQ")),l(4),d(s.inStock?"En Stock":"Sin Stock"),l(3),d(s.isActive?"Activo":"Inactivo"),l(1),p("routerLink",K(9,xe,s.id))}}var de=(()=>{let r=class r{constructor(){this._productService=m(R),this._subscriptions=new _,this.categories$=m(V).getCategories(),this.productCount$=this._productService.getProductCount(),this.listState=[],this.diplayFilters=!1,this.searchControl=new ie(""),this._subscriptions.add(this.getProductList()),this._subscriptions.add(this.searchProduct()),m(E).onDestroy(()=>this._subscriptions.unsubscribe())}getProductList(){return this._productService.getProducts().subscribe(o=>{this.listState=o})}searchProduct(){return this.searchControl.valueChanges.pipe(j(300),q(),G(o=>typeof o=="string"),O(o=>o),C(o=>o.trim()===""?this._productService.getProducts():this._productService.getProductsBy({query:o,field:"name",limit:50}))).subscribe(o=>{this.listState=o})}clearSearchQuery(){this.searchControl.setValue("")}toggleDisplayFilters(){this.diplayFilters=!this.diplayFilters}};r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=y({type:r,selectors:[["app-product-list"]],standalone:!0,features:[P],decls:22,vars:6,consts:[[1,"view-wrapper"],[1,"fs-3","mb-3"],[1,"d-flex","justify-content-between"],[1,"d-flex","mb-2","align-items-center"],["type","text","placeholder","Buscar producto",1,"form-control",3,"formControl"],[1,"btn",3,"click"],[1,"small-text"],[1,"d-flex","column-gap-2","align-items-start"],[1,"btn","btn-outline-secondary",3,"click"],["routerLink","add",1,"btn","btn-primary"],["class","mb-4"],[1,"list-group"],[1,"mb-4"],[1,"mb-3"],[1,"fw-medium","mb-1"],["for","stockSelect",1,"form-label","fw-medium"],["aria-label","Stock select","id","stockSelect",1,"form-select","form-select-sm"],["selected",""],["value","true"],["value","false"],["for","stateSelect",1,"form-label","fw-medium"],["aria-label","State select","id","stateSelect",1,"form-select","form-select-sm"],[1,"form-check"],["type","checkbox","title","category checkbox",1,"form-check-input",3,"id"],[1,"form-check-label",3,"for"],["class","form-check"],[1,"list-group-item","d-flex","justify-content-between","align-items-center"],[1,"ms-2","me-auto"],[1,"fw-medium"],[1,"d-flex","ms-3","column-gap-5","align-items-center"],[1,"mb-0"],[1,"badge","bg-success","rounded-pill"],[1,"btn",3,"routerLink"],["class","list-group-item d-flex justify-content-between align-items-center"]],template:function(a,c){a&1&&(t(0,"div",0)(1,"h1",1),i(2,"Productos"),e(),t(3,"div")(4,"div",2)(5,"div")(6,"div",3),f(7,"input",4),t(8,"button",5),S("click",function(){return c.clearSearchQuery()}),i(9,"Limpiar"),e()(),t(10,"p",6),i(11),v(12,"async"),e()(),t(13,"div",7)(14,"button",8),S("click",function(){return c.toggleDisplayFilters()}),i(15," Filtrar "),e(),t(16,"button",9),i(17,"Nuevo Producto"),e()()(),U(18,he,28,2,"div",10),t(19,"div",11),g(20,_e,18,11,"div",33,me),e()()()),a&2&&(l(7),p("formControl",c.searchControl),l(4),J(" Mostrando ",c.listState.length," resultados de ",x(12,4,c.productCount$)," "),l(7),Q(18,c.diplayFilters?18:-1),h(20,c.listState))},dependencies:[k,F,X,A,T,D,M,I,N,w,re,te,ee],styles:[".view-wrapper[_ngcontent-%COMP%]{max-width:800px;margin:0 auto}.small-text[_ngcontent-%COMP%]{font-size:14px}"]});let n=r;return n})();var Ce=(n,r)=>r.id;function ye(n,r){if(n&1&&(t(0,"option",22),i(1),e()),n&2){let s=r.$implicit;p("value",s.id),l(1),d(s.name)}}var $=(()=>{let r=class r{constructor(){this._activatedRoute=m(Y),this._router=m(Z),this._productService=m(R),this._subscriptions=new _,this.categories$=m(V).getCategories(),this.productId=null,this.pageTitle="Crear producto",this.productForm=m(ce).nonNullable.group({name:["",[u.required,u.minLength(3)]],barcode:[""],sellingPrice:[0,[u.required,u.min(.01)]],categoryId:[0,[u.required,u.min(1)]],inStock:[!0,u.required],isActive:[!0,u.required]}),this._subscriptions.add(this.getProductDetails()),m(E).onDestroy(()=>this._subscriptions.unsubscribe())}getProductDetails(){return this._activatedRoute.paramMap.pipe(C(o=>{let a=o.get("id");return a?(this.productId=parseInt(a),this.pageTitle="Editar producto",this._productService.getProductById(this.productId)):B(null)})).subscribe(o=>{o&&this.setInitialValues(o)})}setInitialValues(o){let{name:a,barcode:c,sellingPrice:b,categoryId:ue,inStock:pe,isActive:fe}=o;this.productForm.setValue({name:a,barcode:c,sellingPrice:b,categoryId:ue,inStock:pe,isActive:fe})}onSubmitForm(){if(this.productId){let o=this.productForm.getRawValue();this._productService.updateProduct(this.productId,L({},o)).subscribe({next:a=>this.resetAndReturn(),error:a=>console.log(a)})}else{let o=this.productForm.getRawValue();this._productService.createProduct(L({},o)).subscribe({next:a=>this.resetAndReturn(),error:a=>console.log(a)})}}resetAndReturn(){this.productForm.reset(),this._router.navigateByUrl("products")}};r.\u0275fac=function(a){return new(a||r)},r.\u0275cmp=y({type:r,selectors:[["app-product-form"]],standalone:!0,features:[P],decls:46,vars:4,consts:[[1,"product-form"],[1,"fs-4","mb-4"],["autocomplete","off",3,"formGroup","ngSubmit"],[1,"mb-3"],["for","productName",1,"form-label"],["type","text","id","productName","formControlName","name",1,"form-control"],["for","barcode",1,"form-label"],["type","text","id","barcode","formControlName","barcode",1,"form-control"],["for","sellingPrice",1,"form-label"],["type","number","step","0.01","min","0.00","id","sellingPrice","formControlName","sellingPrice",1,"form-control"],["for","category",1,"form-label"],["id","category","formControlName","categoryId",1,"form-select"],["value","0"],["for","stockStatus",1,"form-label"],["id","stockStatus","formControlName","inStock",1,"form-select"],["value","false"],["value","true","selected",""],["for","productStatus",1,"form-label"],["id","productStatus","formControlName","isActive",1,"form-select"],[1,"d-flex","column-gap-2"],["type","button",1,"btn","btn-outline-secondary",3,"click"],["type","submit",1,"btn","btn-primary"],[3,"value"]],template:function(a,c){a&1&&(t(0,"div",0)(1,"h1",1),i(2),e(),t(3,"form",2),S("ngSubmit",function(){return c.onSubmitForm()}),t(4,"div",3)(5,"label",4),i(6,"Producto"),e(),f(7,"input",5),e(),t(8,"div",3)(9,"label",6),i(10,"C\xF3digo Barras"),e(),f(11,"input",7),e(),t(12,"div",3)(13,"label",8),i(14,"Precio Venta"),e(),f(15,"input",9),e(),t(16,"div",3)(17,"label",10),i(18,"Categor\xEDa"),e(),t(19,"select",11)(20,"option",12),i(21,"Escoge una categor\xEDa"),e(),g(22,ye,2,2,"option",22,Ce),v(24,"async"),e()(),t(25,"div",3)(26,"label",13),i(27,"Inventario"),e(),t(28,"select",14)(29,"option",15),i(30,"Sin existencias"),e(),t(31,"option",16),i(32,"Con Existencias"),e()()(),t(33,"div",3)(34,"label",17),i(35,"Estado"),e(),t(36,"select",18)(37,"option",15),i(38,"Desactivado"),e(),t(39,"option",16),i(40,"Activo"),e()()(),t(41,"div",19)(42,"button",20),S("click",function(){return c.resetAndReturn()}),i(43," Cancelar "),e(),t(44,"button",21),i(45,"Guardar cambios"),e()()()()),a&2&&(l(2),d(c.pageTitle),l(1),p("formGroup",c.productForm),h(22,x(24,2,c.categories$)))},dependencies:[k,F,A,T,D,M,I,oe,le,N,w,se,ne,ae],styles:[".product-form[_ngcontent-%COMP%]{max-width:480px;width:100%;margin-left:auto;margin-right:auto}"]});let n=r;return n})();var Ee=[{path:"",pathMatch:"full",component:de},{path:"add",component:$},{path:"edit/:id",component:$},{path:"**",redirectTo:""}],He=Ee;export{He as default};
