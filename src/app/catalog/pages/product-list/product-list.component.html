<h1 class="fs-3 mb-3">Productos</h1>

<div>
  <div class="d-flex justify-content-between">
    <div>
      <div class="d-flex mb-2 align-items-center">
        <input
          type="text"
          placeholder="Buscar producto"
          [formControl]="searchControl"
          class="form-control"
        />
        <button class="btn" (click)="clearSearchQuery()">Limpiar</button>
      </div>
      <p class="small-text">
        Mostrando {{ listState.length }} resultados de
        {{ productCount$ | async }}
      </p>
    </div>

    <div class="d-flex column-gap-2 align-items-start">
      <button
        class="btn btn-outline-secondary"
        (click)="toggleDisplayFilters()"
      >
        Filtrar
      </button>
      <button class="btn btn-primary" routerLink="add">Nuevo Producto</button>
    </div>
  </div>
  @if (diplayFilters) {
    <div class="mb-4">
      <div class="mb-3">
        <p class="fw-medium mb-1">Categor√≠as</p>
        <form>
          @for (item of categories$ | async; track item.id) {
            <div class="form-check">
              <input
                type="checkbox"
                [id]="item.name"
                title="category checkbox"
                class="form-check-input"
              />
              <label [for]="item.name" class="form-check-label">
                {{ item.name }}
              </label>
            </div>
          }
        </form>
      </div>
      <div class="mb-3">
        <label for="stockSelect" class="form-label fw-medium"
          >Existencias</label
        >
        <select
          class="form-select form-select-sm"
          aria-label="Stock select"
          id="stockSelect"
        >
          <option selected>Todos los registros</option>
          <option value="true">En existencia</option>
          <option value="false">Sin existencias</option>
        </select>
      </div>
      <div>
        <label for="stateSelect" class="form-label fw-medium">Estado</label>
        <select
          class="form-select form-select-sm"
          aria-label="State select"
          id="stateSelect"
        >
          <option selected>Todos los registros</option>
          <option value="true">Activo</option>
          <option value="false">Inactivo</option>
        </select>
      </div>
    </div>
  }
  <div class="list-group">
    @for (item of listState; track item.id) {
      <div
        class="list-group-item d-flex justify-content-between align-items-center"
      >
        <div class="ms-2 me-auto">
          <div class="fw-medium">{{ item.name }}</div>
          <div class="small-text">{{ item.barcode }}</div>
        </div>
        <div class="d-flex ms-3 column-gap-5 align-items-center">
          <p class="mb-0">{{ item.sellingPrice | currency: "GTQ" }}</p>
          <div>
            <span class="badge bg-success rounded-pill">{{
              item.inStock ? "En Stock" : "Sin Stock"
            }}</span>
          </div>
          <div>
            <span class="badge bg-success rounded-pill">{{
              item.isActive ? "Activo" : "Inactivo"
            }}</span>
          </div>
          <button class="btn" [routerLink]="['edit', item.id]">Editar</button>
        </div>
      </div>
    }
  </div>
</div>
